<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding ITNs and IRS â€¢ hanojoel</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adding ITNs and IRS">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hanojoel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/run_model.html">Simplest Model Run</a>
    </li>
    <li>
      <a href="../articles/create_r_model.html">More Flexible Model Run</a>
    </li>
    <li>
      <a href="../articles/intro_to_nets.html">Adding ITNs and IRS</a>
    </li>
    <li class="divider">
    <li>
      <a href="../CONTRIBUTING.html">Contributing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrc-ide/hanojoel">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Adding ITNs and IRS</h1>
                        <h4 class="author">H. Juliette T. Unwin</h4>
            
            <h4 class="date">2019-05-24</h4>
      
      
      <div class="hidden name"><code>intro_to_nets.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Insecticide treated nets (ITNs) and Indoor Residual Spraying (IRS) can be added to the default deterministic Imperial Malaria model easily. As in the original Berkeley Madonna code, which can be found in the wiki <a href="https://github.com/mrc-ide/deterministic-malaria-model/wiki/Berkeley-Madonna-Code">here</a>, the impact of four different interventions can be considered. This is implemented by splitting the population into a maximum of four different compartments:</p>
<ol style="list-style-type: decimal">
<li>People with no intervention coverage.</li>
<li>People with only ITNs.</li>
<li>People with only IRS.</li>
<li>People with both ITNs and IRS.</li>
</ol>
<p>Each of these compartments is then modelled separately, with all contributing to a share force of infection from humans to mosquitoes.</p>
<p>The population can be split in the following ways:</p>
<ol style="list-style-type: decimal">
<li>In the <code>odin_model.R</code> model, the population is split according to the following equation where<code>itn_cov</code> is the percentage of the population who use nets and <code>irs_cov</code> is the percentage of the population who use indoor residual spraying.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">itn_cov =<span class="st"> </span><span class="fl">0.5</span>
irs_cov =<span class="st"> </span><span class="fl">0.5</span>
cov &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>((<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>itn_cov) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>irs_cov), itn_cov <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>irs_cov), (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>itn_cov) <span class="op">*</span><span class="st"> </span>irs_cov, itn_cov <span class="op">*</span><span class="st"> </span>irs_cov)</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>In the <code>odin_model_itn.R</code> there are two ways to split the population.
<ul>
<li><p>A vector can be provided to the function <code>create_r_model</code>, which specifies the proportion of people in each intervention compartment and sums to one. It is important to maintain the order: people with no intervention coverage, people with only ITNs, people with only IRS and people with both ITNs and IRS. If there is no IRS in the simulation, only two compartments need to be specified. At present, a<br>
percentage of the population has to be assigned to ITNs if IRS is included in the model. For example, for a 50% split of no coverage of ITNs and IRS the following vector is provided: <code>pop_split = c(0.5, 0.5)</code>.</p></li>
<li><p>If no coverage vector is provided, then population is split by default. If a vector of varying<br>
coverages is provided, the population is split equally between all the active population groups.</p></li>
</ul>
</li>
</ol>
</div>
<div id="implementation-of-interventions" class="section level2">
<h2 class="hasAnchor">
<a href="#implementation-of-interventions" class="anchor"></a>Implementation of interventions</h2>
<p>There are two different ways of implementing these intervention.</p>
<ol style="list-style-type: decimal">
<li>Allow a step change in ITNs and IRS at a prescribed time.</li>
<li>Vary ITNs over the time period being considered and allow a step change in IRS which corresponds to the time nets are first introduced.</li>
</ol>
<div id="step-change-in-interventions" class="section level3">
<h3 class="hasAnchor">
<a href="#step-change-in-interventions" class="anchor"></a>Step change in interventions</h3>
<p>These interventions can be switched on in the <code>odin_model.R</code> model by providing a start time for the interventions and the percentage of people who are covered. For example, for a non seasonal location with a 50% coverage of nets and 50% coverage of IRS that gets turned on after one year:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(hanojoel)
<span class="co"># creates the odin model</span>
wh &lt;-<span class="st"> </span>hanojoel<span class="op">:::</span><span class="kw"><a href="../reference/create_r_model.html">create_r_model</a></span>(<span class="dt">odin_model_path =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata/odin_model.R"</span>,
                                                              <span class="dt">package =</span> <span class="st">"hanojoel"</span>),
                                <span class="dt">num_int =</span> <span class="dv">4</span>,
                                <span class="dt">itn_cov =</span> <span class="fl">0.5</span>, <span class="co"># ITN coverage</span>
                                <span class="dt">irs_cov =</span> <span class="fl">0.5</span>, <span class="co"># IRS coverage</span>
                                <span class="dt">ITN_IRS_on =</span> <span class="dv">1</span><span class="op">*</span><span class="dv">365</span>) <span class="co"># Start time for interventions</span>
<span class="co"># generates model functions with initial state data</span>
mod &lt;-<span class="st"> </span>wh<span class="op">$</span><span class="kw">generator</span>(<span class="dt">user=</span> wh<span class="op">$</span>state, <span class="dt">use_dde =</span> <span class="ot">TRUE</span>)
<span class="co"># Runs the model</span>
mod_run &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">run</span>(<span class="dt">t =</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">365</span><span class="op">*</span><span class="dv">3</span>))
out &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">transform_variables</span>(mod_run)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(out<span class="op">$</span>t, out<span class="op">$</span>prev, <span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">col=</span><span class="st">'black'</span>, <span class="dt">main=</span><span class="st">'Prevalance'</span>)</code></pre></div>
<p><img src="intro_to_nets_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>If no start time for interventions is provided, the default is to set <code>ITN_IRS_on = -1</code>. This represents the inteventions being implemented from the start of the simulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(hanojoel)
<span class="co"># creates the odin model</span>
wh &lt;-<span class="st"> </span>hanojoel<span class="op">:::</span><span class="kw"><a href="../reference/create_r_model.html">create_r_model</a></span>(<span class="dt">odin_model_path =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata/odin_model.R"</span>,
                                                              <span class="dt">package =</span> <span class="st">"hanojoel"</span>),
                                <span class="dt">num_int =</span> <span class="dv">4</span>,
                                <span class="dt">itn_cov =</span> <span class="fl">0.5</span>, <span class="co"># ITN coverage</span>
                                <span class="dt">irs_cov =</span> <span class="fl">0.5</span>) <span class="co"># IRS coverage) # Start time for interventions</span>
<span class="co"># generates model functions with initial state data</span>
mod &lt;-<span class="st"> </span>wh<span class="op">$</span><span class="kw">generator</span>(<span class="dt">user=</span> wh<span class="op">$</span>state, <span class="dt">use_dde =</span> <span class="ot">TRUE</span>)
<span class="co"># Runs the model</span>
mod_run &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">run</span>(<span class="dt">t =</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">365</span><span class="op">*</span><span class="dv">3</span>))
out &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">transform_variables</span>(mod_run)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(out<span class="op">$</span>t, out<span class="op">$</span>prev, <span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">col=</span><span class="st">'black'</span>, <span class="dt">main=</span><span class="st">'Prevalance'</span>)</code></pre></div>
<p><img src="intro_to_nets_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="varying-interventions" class="section level3">
<h3 class="hasAnchor">
<a href="#varying-interventions" class="anchor"></a>Varying interventions</h3>
<p>It may be desirable to change the net coverage more than once over a simulation. This is achieved by providing two vectors <code>itn_vector</code> and <code>t_vector</code> to the <code>create_r_model</code> function using the <code>odin_model_itn.R</code> version of the model. Here the <code>itn_vector</code> vector dictates how the coverage changes and <code>t_vector</code> is the time in days that the coverages change. For example for a non seasonal setting with 50% population split:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(hanojoel)
<span class="co"># define the net coverage. </span>
<span class="co"># Need to define the coverage in the past so can have a coverage using the delay</span>
itn_vector &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>)
t_vector &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">1</span><span class="op">*</span><span class="dv">365</span>, <span class="dv">2</span><span class="op">*</span><span class="dv">365</span>) <span class="co"># number of days at which the itn coverage changes</span>
<span class="co"># creates the odin model</span>
wh &lt;-<span class="st"> </span>hanojoel<span class="op">:::</span><span class="kw"><a href="../reference/create_r_model.html">create_r_model</a></span>(<span class="dt">odin_model_path =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata/odin_model_itn.R"</span>,
                                                              <span class="dt">package =</span> <span class="st">"hanojoel"</span>),
                                <span class="dt">num_int =</span> <span class="dv">2</span>, 
                                <span class="dt">itn_vector =</span> itn_vector,
                                <span class="dt">t_vector =</span> t_vector,
                                <span class="dt">pop_split =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))
<span class="co"># generates model functions with initial state data</span>
mod &lt;-<span class="st"> </span>wh<span class="op">$</span><span class="kw">generator</span>(<span class="dt">user=</span> wh<span class="op">$</span>state, <span class="dt">use_dde =</span> <span class="ot">TRUE</span>)
<span class="co"># Runs the model</span>
mod_run &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">run</span>(<span class="dt">t =</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">365</span><span class="op">*</span><span class="dv">3</span>))
out &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">transform_variables</span>(mod_run)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(out<span class="op">$</span>t, out<span class="op">$</span>prev, <span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">col=</span><span class="st">'black'</span>, <span class="dt">main=</span><span class="st">'Prevalance'</span>)</code></pre></div>
<p><img src="intro_to_nets_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>At present varing IRS has not been implemented. IRS can only be added to the simulation as shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(hanojoel)
<span class="co"># define the net coverage. </span>
itn_vector &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>)
t_vector &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">25</span>, <span class="dv">1</span><span class="op">*</span><span class="dv">365</span>, <span class="dv">2</span><span class="op">*</span><span class="dv">365</span>) <span class="co"># number of days at which the itn coverage changes</span>
<span class="co"># creates the odin model</span>
wh &lt;-<span class="st"> </span>hanojoel<span class="op">:::</span><span class="kw"><a href="../reference/create_r_model.html">create_r_model</a></span>(<span class="dt">odin_model_path =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata/odin_model_itn.R"</span>,
                                                              <span class="dt">package =</span> <span class="st">"hanojoel"</span>),
                                <span class="dt">num_int =</span> <span class="dv">4</span>,
                                <span class="dt">itn_vector =</span> itn_vector,
                                <span class="dt">t_vector =</span> t_vector,
                                <span class="dt">irs_cov =</span> <span class="fl">0.2</span>,
                                <span class="dt">pop_split =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>))
<span class="co"># generates model functions with initial state data</span>
mod &lt;-<span class="st"> </span>wh<span class="op">$</span><span class="kw">generator</span>(<span class="dt">user=</span> wh<span class="op">$</span>state, <span class="dt">use_dde =</span> <span class="ot">TRUE</span>)
<span class="co"># Runs the model</span>
mod_run &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">run</span>(<span class="dt">t =</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">365</span><span class="op">*</span><span class="dv">3</span>))
out &lt;-<span class="st"> </span>mod<span class="op">$</span><span class="kw">transform_variables</span>(mod_run)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(out<span class="op">$</span>t, out<span class="op">$</span>prev, <span class="dt">type=</span><span class="st">'l'</span>, <span class="dt">col=</span><span class="st">'black'</span>, <span class="dt">main=</span><span class="st">'Prevalance'</span>)</code></pre></div>
<p><img src="intro_to_nets_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>This represents 20% of the population recieving IRS beginning at day 365.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#implementation-of-interventions">Implementation of interventions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Joel Hellewell, Hannah Slater, Juliette Unwin, OJ Watson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
