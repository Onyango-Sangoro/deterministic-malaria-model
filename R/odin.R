## This file was automatically generated by odin.
## Do not edit by hand as changes will be lost.
.R6_odin_model <- R6::R6Class(
  "odin_model",
  parent_env = environment(odin::odin),
  public = list(
    name = "odin_model",
    ptr = NULL,
    use_dde = NULL,
    ## Cache:
    init = NULL,
    variable_order = NULL,
    output_order = NULL,
    output_length = NULL,
    names = NULL,
    transform_variables = NULL,
    ## Methods:
    initialize = function(user = NULL, use_dde = FALSE) {
      self$ptr <- .Call("odin_model_create", user, use_dde, PACKAGE = "hanojoel")
      self$use_dde <- use_dde
      if (use_dde) {
        loadNamespace("dde")
      }
      self$update_cache()
    },

    set_user = function(..., user = list(...)) {
      .Call("r_odin_model_set_user", self$ptr, user, PACKAGE = "hanojoel")
      self$update_cache()
      invisible(self$init)
    },

    update_cache = function() {
      self$variable_order <- .Call("odin_model_variable_order", self$ptr, PACKAGE = "hanojoel")
      self$output_order <- .Call("odin_model_output_order", self$ptr, PACKAGE = "hanojoel")
      odin_prepare(self, FALSE)
    },

    initial = function(t) {
      .Call("odin_model_initialise", self$ptr, as.numeric(t), PACKAGE = "hanojoel")
    },

    run = function(t, y = NULL, ..., use_names = TRUE, n_history = 1000L) {
      if (is.null(y)) {
        y <- self$initial(t[[1L]])
      } else {
        .Call("odin_model_set_initial", self$ptr, t, y, PACKAGE = "hanojoel")
      }
      if (self$use_dde) {
        ret <- dde::dopri(y, t, "odin_model_deriv_dde", self$ptr,
                          dllname = "hanojoel",
                          n_out = self$output_length, output = "odin_model_output_dde",
                          n_history = n_history, return_history = FALSE,
                          parms_are_real = FALSE, ynames = FALSE, ...)
      } else {
        ret <- deSolve::dede(y, t, "odin_model_deriv_ds", self$ptr,
                             initfunc = "odin_model_initmod_ds", dllname = "hanojoel",
                             nout = self$output_length,
                             control = list(mxhist = n_history),
                             ...)
      }
      if (use_names) {
        colnames(ret) <- self$names
      } else {
        colnames(ret) <- NULL
      }
      ret
    },

    contents = function() {
      .Call("odin_model_contents", self$ptr, PACKAGE = "hanojoel")
    }
  ))
odin_model <- function(na, nh, ft, eta, rA, rT, rD, rU, rP, dCM, uCA, dCA, dB, uB, dID, uD, phi0, phi1, IC0, kC, b0, b1, kB, IB0, aD, fD0, gammaD, d1, ID0, kD, dE, pi, ssa0, ssa1, ssa2, ssa3, ssb1, ssb2, ssb3, theta_c, init_Sv, init_Ev, init_Iv, cU, cD, cT, gamma1, omega, delayGam, delayMos, dLL, dPL, dEL, muLL, muPL, muEL, gammaL, mv0, tau1, tau2, p10, p2, beta_larval0, init_PL, init_LL, init_EL, ITN_IRS_on, num_int, itn_cov, irs_cov, IRS_interval, ITN_interval, chi, Q0, bites_Bed, bites_Indoors, r_ITN0, d_ITN0, d_IRS0, r_IRS0, r_ITN1, irs_loss, itn_loss, age59, age05, age_rate, het_wt, init_S, init_T, init_D, init_A, init_U, init_P, x_I, init_ICM, init_ICA, init_IB, init_ID, age, foi_age, rel_foi, den, user = list(na = na, nh = nh, ft = ft, eta = eta, rA = rA, rT = rT, rD = rD, rU = rU, rP = rP, dCM = dCM, uCA = uCA, dCA = dCA, dB = dB, uB = uB, dID = dID, uD = uD, phi0 = phi0, phi1 = phi1, IC0 = IC0, kC = kC, b0 = b0, b1 = b1, kB = kB, IB0 = IB0, aD = aD, fD0 = fD0, gammaD = gammaD, d1 = d1, ID0 = ID0, kD = kD, dE = dE, pi = pi, ssa0 = ssa0, ssa1 = ssa1, ssa2 = ssa2, ssa3 = ssa3, ssb1 = ssb1, ssb2 = ssb2, ssb3 = ssb3, theta_c = theta_c, init_Sv = init_Sv, init_Ev = init_Ev, init_Iv = init_Iv, cU = cU, cD = cD, cT = cT, gamma1 = gamma1, omega = omega, delayGam = delayGam, delayMos = delayMos, dLL = dLL, dPL = dPL, dEL = dEL, muLL = muLL, muPL = muPL, muEL = muEL, gammaL = gammaL, mv0 = mv0, tau1 = tau1, tau2 = tau2, p10 = p10, p2 = p2, beta_larval0 = beta_larval0, init_PL = init_PL, init_LL = init_LL, init_EL = init_EL, ITN_IRS_on = ITN_IRS_on, num_int = num_int, itn_cov = itn_cov, irs_cov = irs_cov, IRS_interval = IRS_interval, ITN_interval = ITN_interval, chi = chi, Q0 = Q0, bites_Bed = bites_Bed, bites_Indoors = bites_Indoors, r_ITN0 = r_ITN0, d_ITN0 = d_ITN0, d_IRS0 = d_IRS0, r_IRS0 = r_IRS0, r_ITN1 = r_ITN1, irs_loss = irs_loss, itn_loss = itn_loss, age59 = age59, age05 = age05, age_rate = age_rate, het_wt = het_wt, init_S = init_S, init_T = init_T, init_D = init_D, init_A = init_A, init_U = init_U, init_P = init_P, x_I = x_I, init_ICM = init_ICM, init_ICA = init_ICA, init_IB = init_IB, init_ID = init_ID, age = age, foi_age = foi_age, rel_foi = rel_foi, den = den), use_dde = FALSE) {
  .R6_odin_model$new(user = user, use_dde = use_dde)
}
